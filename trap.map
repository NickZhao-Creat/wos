GAS LISTING trap.s 			page 1


   1              	.include "gdt.h"
   1              	#ifndef GDT_H
   2              	#define GDT_H
   3              	
   4              	#define KERNEL_CODE_TYPE        0x9a
   5              	#define KERNEL_DATA_TYPE        0x92
   6              	#define VIDEO_TYPE              KERNEL_DATA_TYPE
   7              	
   8              	#define DESC_DEFAULT_TYPE       0xc
   9              	
  10              	#define KERNEL_CODE_DESC        0x1
  11              	#define KERNEL_DATA_DESC        0x2
  12              	#define VIDEO_DESC              0x3
  13              	
  14              	#define CODE_LIMIT              0xffffffff
  15              	#define DATA_LIMIT              CODE_LIMIT
  16              	
  17              	#define CODE_BASE               0x0
  18              	#define DATA_BASE               CODE_BASE
  19              	
  20              	#define VIDEO_LIMIT             0xffff
  21              	#define VIDEO_BASE              0xb8000
  22              	
  23              	#define KERNEL_CODE_SEL		0x08	/* 01000 */
  24              	#define KERNEL_DATA_SEL		0x10	/* 10000 */
  25              	
  26              	#endif
   2              	.align 2
   3              	.global default_int
   4              	default_int:
   5 0000 50       		pushl %eax
   6 0001 51       		pushl %ecx
   7 0002 52       		pushl %edx
   8 0003 1E       		push %ds
   9 0004 06       		push %es
  10 0005 0FA0     		push %fs
  11 0007 B8100000 		movl $0x10, %eax
  11      00
  12 000c 8ED8     		mov %ax, %ds
  13 000e 8EC0     		mov %ax, %es
  14 0010 8EE0     		mov %ax, %fs
  15 0012 68250000 		pushl $default_int_msg
  15      00
  16 0017 E8FCFFFF 		call printk
  16      FF
  17 001c 58       		popl %eax
  18 001d 0FA1     		pop %fs
  19 001f 07       		pop %es
  20 0020 1F       		pop %ds
  21 0021 5A       		popl %edx
  22 0022 59       		popl %ecx
  23 0023 58       		popl %eax
  24 0024 CF       		iret
  25              	
  26              	default_int_msg:
  27 0025 556E6B6F 		.asciz "Unkown Interrupt."
  27      776E2049 
GAS LISTING trap.s 			page 2


  27      6E746572 
  27      72757074 
  27      2E00
GAS LISTING trap.s 			page 3


DEFINED SYMBOLS
              trap.s:4      .text:0000000000000000 default_int
              trap.s:26     .text:0000000000000025 default_int_msg

UNDEFINED SYMBOLS
printk
